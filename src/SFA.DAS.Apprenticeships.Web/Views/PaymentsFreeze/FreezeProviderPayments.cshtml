@using Microsoft.AspNetCore.Mvc.TagHelpers
@using SFA.DAS.Provider.Shared.UI.TagHelpers
@model SFA.DAS.Apprenticeships.Web.Models.PaymentsFreeze.FreezeProviderPaymentsModel
@{
    ViewData["Title"] = "Freeze provider payments - Manage apprenticeships";
    const int MaxCharacters = 200;
    var charactersRemaining = MaxCharacters - Model.ReasonForFreeze?.Length ?? MaxCharacters;
}

<div class="govuk-width-container ">

    @*Renders href as href="https://approvals.{domain}/{ProviderReferenceNumber}/apprentices/{ApprenticeshipHashedId}" *@
    <a class="govuk-back-link" href="@Model.BackLinkUrl">
        Back
    </a>

    <main class="govuk-main-wrapper govuk-main-wrapper--auto-spacing" id="main-content" role="main">

        <form method="post" action="/employer/@Model.EmployerAccountId/PaymentsFreeze/@Model.ApprenticeshipHashedId">
            @Html.AntiForgeryToken()
            @Html.HiddenFor(m => m.ApprenticeshipKey)
            @Html.HiddenFor(m => m.FreezePayments)
            <div class="govuk-grid-row">
                <div class="govuk-grid-column-two-thirds">

                    <h1 class="govuk-heading-l">Freeze provider payments</h1>
                    <p>
                        Only use this if you have a dispute with the training provider and need to freeze training provider payments.

                        The learner status will not be changed. If you need to change learner status, contact the training provider.
                    </p>
                    <details class="govuk-details">
                        <summary class="govuk-details__summary">
                            <span class="govuk-details__summary-text">
                                What does freezing payments do?
                            </span>
                        </summary>
                        <div class="govuk-details__text">
                            Freezing your payments suspends all transactions to the payment provider. If payments are frozen on the
                            scheduled
                            payment day, no funds will be transferred to the provider for that specific period.
                        </div>
                    </details>
                    <div class="govuk-form-group govuk-!-margin-top-7">
                        <fieldset class="govuk-fieldset">
                            <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
                                Do you want to freeze training provider payments?
                            </legend>
                            
                            <div class="govuk-radios">
                                <div class="govuk-radios__item" id="radio-item-yes">
                                    <input class="govuk-radios__input" type="radio" id="option-yes" name="FreezePayments" value="1" onchange="javascript: showHideFreezeReason();">
                                    <label class="govuk-label govuk-radios__label" for="option-yes">Yes, freeze future payments</label>
                                </div>
                                @* <div class="govuk-radios__conditional govuk-radios__conditional--hidden" id="freezeReasonContainer"> *@
                                <div id="freezeReasonContainer">
                                    <div class="govuk-form-group">
                                        <label class="govuk-label">
                                            Specify reason for freezing training provider payments (optional)
                                        </label>
                                        <div id="reason-for-freeze-hint" class="govuk-hint">
                                            This reason will be shared with the training provider
                                        </div>
                                        <div class="govuk-character-count" data-module="govuk-character-count" data-maxlength="200">
                                            <div class="govuk-form-group">
                                                <div id="reason-for-freeze" class="govuk-hint govuk-character-count__message">
                                                    @Html.TextAreaFor(m => m.ReasonForFreeze, new { @class = $"govuk-textarea", rows = "5", aria_describedby = "reason-for-freeze-hint", maxlength = MaxCharacters, onkeyup = $"calculateRemainingCharacters(this, {MaxCharacters}, 'ReasonForFreeze-RemainingCharacters')" })
                                                </div>
                                                <div id="with-hint-info" class="govuk-hint govuk-character-count__message">
                                                    <span js-enabled-show hidden><span id="ReasonForFreeze-RemainingCharacters">@charactersRemaining</span> characters remaining</span>
                                                    <span js-enabled-hide>Max @MaxCharacters characters</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="govuk-radios__item" id="radio-item-no">
                                    <input class="govuk-radios__input" type="radio" id="option-no" name="FreezePayments" value="0" onchange="javascript: showHideFreezeReason();">
                                    <label class="govuk-label govuk-radios__label" for="option-no">No</label>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                </div>
            </div>
            <button class="govuk-button" data-module="govuk-button" type="submit" id="buttonSubmitForm">
                Confirm changes
            </button>

        </form>
    </main>
</div>

<script type="text/javascript">
    function showHideFreezeReason() {
        console.log(document.getElementById("option-yes").checked);
        if (!document.getElementById("option-yes").checked) {
            document.getElementById("freezeReasonContainer").style.display = "none";
        } else {
            document.getElementById("freezeReasonContainer").style.display = "block";
        }
    }

    showHideFreezeReason();
</script>